# 멀티 스레드

- 멀티스레딩의 장점

  - 메모리 공간과 시스템 자원의 소모 감소
  - 스레드 간 통신은 전역 변수, 프로세스 힙 영역을 이용 가능 → 프로세스간 통신보다 간단
  - 스레드의 context switch는 프로세스의 context switch와 달리 캐시 메모리를 비울 필요가 없다.
  - 따라서 응답 시간이 단축된다

- 멀티스레딩의 문제점

  - 멀티 프로세스는 전혀 다른 프로그램(프로세스)이기 때문에 프로세스 간 공유하는 자원이 없다. (한글이랑 독스는 서로 같은 파일 못바꿈)
  - 하지만 한 프로세스 안의 스레드는 같은 자원을 수정할 수 있고(데이터와 힙영역을 공유하기 때문), 이에 대한 처리를 제대로 하지 않으면 이전 스레드가 바꿔버린 값을 가져와서 원치 않는 값을 받거나, 오류가 생길 수 있다.
  - 그래서 동기화 작업이 필요하다. 작업 순서를 보장하거나, 공유 자원에 대한 접근을 제어
  - 하지만 이에 따라 병목현상이 발생하여 성능 저하가 생길 수 있다. 이점을 잘 해결해야한다.

- 멀티 프로세스 vs 멀티 스레드

  - 멀티 스레드는 멀티 프로세스보다 적은 메모리 공간을 차지하고 문맥 전환이 빠르다는 장점이 있지만, 오류로 인해 하나의 스레드가 종료되면 전체 스레드가 종료될 수 있다는 점과 동기화 문제를 안고 있다.

  - 반면 멀티 프로세스 방식은 하나의 프로세스가 죽더라도 다른 프로세스에는 영향을 끼치지 않고 정상적으로 수행된다는 장점이 있지만, 멀티 스레드보다 많은 메모리 공간과 CPU 시간을 차지한다는 단점이 존재한다.

  - 이 두 가지는 동시에 여러 작업을 수행한다는 점에서 같지만 적용해야 하는 시스템에 따라 적합/부적합이 구분된다. 따라서 대상 시스템의 특징에 따라 적합한 동작 방식을 선택하고 적용해야 한다.

  - 그래서 어떤 상황에서 뭐가 좋고 우리 플젝에서는 뭐씀??

    - JS는 싱글 스레드임.. 

      왜?

      - 웹페이지에서 발생하는 동시성 문제를 해결하지 않아도 된다.
      - 교착상태를 피할 수 있다.
      - 비동기 처리로 여러 요청을 쉽게 처리 할 수 있다.

    - JS의 이벤트 루프가 싱글 스레드

    - 하지만 브라우저, NodeJS는 멀티 스레드

    - 따라서 JS의 런타임은 싱글 스레드가 아니다.

    - JS는 함수 콜 스택, 이벤트 루프, 테스크 큐, 웹 API로 구성됨

      - 콜스택은 지금 실행하고 있는 함수를 담은 함수 콜 스택
      - 웹 API는 웹브라우저에서 제공하는 API
      - 이벤트 루프는 테스크 큐에 쌓여있는 이벤트를 체크하여 실행해주는 역할, 콜스택이 비면 테스크큐의 작업을 옮김
      - 테스크 큐는 웹 API에서 넘겨받은 콜백함수를 저장